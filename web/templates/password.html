{{ template "header.html" . }}

<div class="theme-panel theme-panel--signin">
  <h2 class="theme-heading theme-heading--signin">Sign In</h2>
  <form method="post" action="{{ .PostURL }}">
    <div class="theme-form-row">
      <div class="theme-form-label">
        <label for="userid">Email</label>
      </div>
	  <input tabindex="1" required id="login" name="login" type="text" class="theme-form-input custom-input" placeholder="{{ .UsernamePrompt | lower }}" {{ if .Username }} value="{{ .Username }}" {{ else }} autofocus {{ end }}/>
    </div>
    <div class="theme-form-row">
      <div class="theme-form-label">
        <label for="password">Password</label>
      </div>
	  <div class="password-field-wrapper">
		  <input tabindex="2" required id="password" name="password" type="password" class="theme-form-input custom-input" placeholder="password" {{ if .Invalid }} autofocus {{ end }} />
		  <button type="button" id="toggle-password" aria-label="Show password" class="toggle-password-button">
			  <img id="toggle-password-icon" src="{{ url .ReqPath "static/img/eye-solid-full.svg" }}" alt="Show password" />
		  </button>
	  </div>
    </div>

    {{ if .Invalid }}
      <div id="login-error" class="dex-error-box">
        Invalid {{ .UsernamePrompt }} and password.
      </div>
    {{ end }}

    <button tabindex="3" id="submit-login" type="submit" class="dex-btn theme-btn--primary login-button">Sign In</button>

  </form>
  {{ if .BackLink }}
  <div class="theme-link-back">
    <a class="dex-subtle-text" href="{{ .BackLink }}">Select another login method</a>
  </div>
  {{ end }}
</div>


<script type="text/javascript">
  document.querySelector('form').onsubmit = function(e) {
    var el = document.querySelector('#submit-login');
    el.setAttribute('disabled', 'disabled');
  };
  (function() {
    var pw = document.getElementById('password');
    var btn = document.getElementById('toggle-password');
    if (pw && btn) {
      var icon = document.getElementById('toggle-password-icon');
      var eye = '{{ url .ReqPath "static/img/eye-solid-full.svg" }}';
      var eyeSlash = '{{ url .ReqPath "static/img/eye-slash-solid-full.svg" }}';
      btn.addEventListener('click', function() {
        var isHidden = pw.type === 'password';
        pw.type = isHidden ? 'text' : 'password';
        if (icon) {
          icon.setAttribute('src', isHidden ? eyeSlash : eye);
          icon.setAttribute('alt', isHidden ? 'Hide password' : 'Show password');
        }
        btn.setAttribute('aria-label', isHidden ? 'Hide password' : 'Show password');
      });
    }
  })();
</script>

{{ template "footer.html" . }}
